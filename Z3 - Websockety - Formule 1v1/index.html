<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Epic Grand Prix</title>

    <!-- Correct Tailwind loading -->
    <script src="https://cdn.tailwindcss.com"></script>

    <script type="module" src="main.js" defer></script>
</head>

<body class="bg-gray-100 flex flex-col items-center justify-center min-h-screen">

    <!-- Landing Page -->
    <div id="landing" class="flex flex-col items-center space-y-6 text-center">
        <h1 class="text-4xl font-bold">Epic Grand Prix</h1>
        <button id="playBtn" class="bg-blue-500 text-white px-6 py-3 rounded-lg hover:bg-blue-600 w-48">Play</button>
        <button id="howToPlayBtn" class="bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 w-48">How to Play</button>
    </div>

    <!-- How to Play Modal -->
    <div id="howToPlayModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-lg shadow-lg w-96 text-center space-y-4">
            <h2 class="text-2xl font-bold">How to Play</h2>
            <p class="text-lg">
                <strong>W</strong> to accelerate,
                <br><strong>A</strong> to steer left,
                <br><strong>D</strong> to steer right.
            </p>
            <button id="closeHowToPlay" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Close</button>
        </div>
    </div>

    <!-- Name Input -->
    <div id="nameInput" class="hidden flex flex-col items-center space-y-4 mt-6">
        <input id="nameField" type="text" placeholder="Enter your name" class="border p-3 rounded w-64">
        <button id="submitNameBtn" class="bg-green-500 text-white px-6 py-3 rounded-lg hover:bg-green-600 w-48">Submit Name</button>
        <button id="backToLandingBtn">Back</button>
    </div>

    <!-- Race Options -->
    <div id="raceOptions" class="hidden flex flex-col items-center space-y-6 mt-6">
        <div id="usernameDisplay" class="text-2xl font-semibold text-gray-700"></div>

        <button id="createRaceBtn" class="bg-purple-500 text-white px-6 py-3 rounded-lg hover:bg-purple-600 w-48">Create a Race</button>
        <button id="connectRaceBtn" class="bg-yellow-500 text-white px-6 py-3 rounded-lg hover:bg-yellow-600 w-48">Connect to a Race</button>
        <button id="backToNameInputBtn">Back</button>
    </div>

    <!-- Choose Laps -->
    <div id="chooseLaps" class="hidden flex flex-col items-center space-y-4 mt-6">
        <label for="lapsInput" class="text-lg">Choose number of laps:</label>
        <input id="lapsInput" type="number" min="1" max="10" value="2" class="border p-3 rounded w-32 text-center">
        <button id="confirmLapsBtn" class="bg-indigo-500 text-white px-6 py-3 rounded-lg hover:bg-indigo-600 w-48">Confirm</button>
        <button id="backToRaceOptionsBtn">Back</button>
    </div>

    <!-- Connect by ID-->
    <div id="connectToRace" class="hidden flex flex-col items-center space-y-4 mt-6">
        <input id="raceIdField" type="text" placeholder="Enter Race ID" class="border p-3 rounded w-64">
        <button id="connectRaceConfirmBtn" class="bg-yellow-500 text-white px-6 py-3 rounded-lg hover:bg-yellow-600 w-48 ">Join Race</button>
        <button id="backToRaceOptionsFromConnectBtn">Back</button>
    </div>

    <!-- Waiting Screen -->
    <div id="waitingScreen" class="hidden flex flex-col items-center space-y-6 mt-6">
        <div id="waitingInfo" class="text-center text-gray-700 text-lg"></div>
    </div>

    <!-- Countdown -->
    <div id="countdownOverlay" class="fixed top-0 left-0 w-full h-full bg-black/70 text-white text-6xl flex items-center justify-center hidden z-50"></div>

    <!-- Game Screen (hidden by default) -->
    <div id="gameScreen" class="relative hidden">
        <canvas id="raceCanvas" width="900" height="700"></canvas>

        <!-- Overlay container sits on top of the canvas -->
        <div id="counters" class="hidden absolute inset-0 flex flex-col items-center justify-center space-y-4 z-20 pointer-events-none">
            <div id="timerDisplay"     class="text-4xl font-bold text-white drop-shadow-lg"></div>
            <div id="lapCounter"       class="text-3xl font-semibold text-white drop-shadow-lg"></div>
            <div id="checkpointCounter"class="text-3xl font-semibold text-white drop-shadow-lg"></div>
            <div id="penaltyInfo"      class="text-2xl font-medium text-red-500 drop-shadow-lg"></div>
        </div>
    </div>

    <!-- Blur and Overlay when Player Finishes -->
    <div id="overlayBlur" class="hidden fixed inset-0 bg-white bg-opacity-40 backdrop-blur-md flex flex-col items-center justify-center z-40">

        <!-- Player Finished Text -->
        <div id="playerFinishedText" class="text-4xl font-bold text-black text-center mb-6"></div>
        <div id="finalTimeDisplay" class="absolute bottom-10 left-1/2 transform -translate-x-1/2 text-2xl text-white font-semibold z-20"></div>

        <!-- Results Content -->
        <div id="resultsContent" class="hidden bg-white bg-opacity-90 rounded-lg shadow-lg p-6 w-96 max-w-full text-center">
            <h2 class="text-2xl font-bold mb-4">Race Results</h2>
            <table class="table-auto w-full border mb-4">
                <thead>
                <tr>
                    <th class="border px-4 py-2">Position</th>
                    <th class="border px-4 py-2">Player</th>
                    <th class="border px-4 py-2">Time</th>
                </tr>
                </thead>
                <tbody id="resultsTableBody"></tbody>
            </table>
            <button id="playAgainBtn" class="px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600">
                Main menu
            </button>
        </div>
    </div>

</body>

</html>